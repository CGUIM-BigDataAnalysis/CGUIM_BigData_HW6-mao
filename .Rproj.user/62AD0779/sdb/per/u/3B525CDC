{
    "collab_server" : "",
    "contents" : "#library(jsonlite)\n#library(rvest)\n#library(data.table)\n#library(dplyr)\n#library(XML)\n#library(RCurl)\n#library(stringr)\n#library(curl)\n#library(httr)\n\nlibrary(readr)\ntraveldata <- read.csv(\"C:/Users/Eileen/Desktop/taiwantravel.csv\",fileEncoding =\"Big5\")\nView(traveldata)\n\ntraveldatan <- traveldata[grepl(\"北部\",traveldata$`居住地區`),] #北部旅遊的表單\n\nlibrary(dplyr)\ngroup_by(traveldatan,.dots=`個人每月平均所得`) %>%\n  summarise(`個人每月平均所得(北)`=n()) %>%\n  arrange(desc(`個人每月平均所得(北)`)) #北部月所得旅遊表單\n\nnorthmoneytd<-traveldatan[grepl(\"無收入\",traveldatan$`個人每月平均所得`),] #北部旅遊無收入的表單\n\nlibrary(dplyr)\ngroup_by(northmoneytd,.dots=`職業`) %>%\n  summarise(`無收入職業(北)`=n()) %>%\n  arrange(desc(`無收入職業(北)`)) #北部無收入職業旅遊表單\n\nnorthmoneyjobtd<-northmoneytd[grepl(\"家庭管理\",northmoneytd$`職業`),]\n\nlibrary(dplyr)\ngroup_by(northmoneyjobtd,.dots=`年齡`) %>%\n  summarise(`無收入家庭管理年齡(北)`=n()) %>%\n  arrange(desc(`無收入家庭管理年齡(北)`)) #北部無收入家庭管理年齡旅遊表單\n\ntraveldatas <- traveldata[grepl(\"南部\",traveldata$`居住地區`),] #南部旅遊的表單\n\nlibrary(dplyr)\ngroup_by(traveldatas,.dots=`個人每月平均所得`) %>%\n  summarise(`個人每月平均所得(南)`=n()) %>%\n  arrange(desc(`個人每月平均所得(南)`)) #南部月所得旅遊表單\n\nsouthmoneytd<-traveldatas[grepl(\"二萬元至未滿三萬元\",traveldatas$`個人每月平均所得`),]\n\nlibrary(dplyr)\ngroup_by(southmoneytd,.dots=`職業`) %>%\n  summarise(`二萬元至未滿三萬元職業(南)`=n()) %>%\n  arrange(desc(`二萬元至未滿三萬元職業(南)`)) #南部二萬~三萬職業旅遊表單\n\nsouthmoneyjobtd<-southmoneytd[grepl(\"服務及銷售工作人員\",southmoneytd$`職業`),]\n\nlibrary(dplyr)\ngroup_by(southmoneyjobtd,.dots=`年齡`) %>%\n  summarise(`二萬元至未滿三萬元服務及銷售工作人員年齡(南)`=n()) %>%\n  arrange(desc(`二萬元至未滿三萬元服務及銷售工作人員年齡(南)`)) #南部二萬~三萬服務及銷售工作人員年齡旅遊表單\n\ntraveldatae <- traveldata[grepl(\"東部\",traveldata$`居住地區`),] #東部旅遊的表單\n\nlibrary(dplyr)\ngroup_by(traveldatae,.dots=`個人每月平均所得`) %>%\n  summarise(`個人每月平均所得(東)`=n()) %>%\n  arrange(desc(`個人每月平均所得(東)`)) #東部月所得旅遊表單\n\neastmoneytd<-traveldatae[grepl(\"未滿一萬元\",traveldatae$`個人每月平均所得`),]\n\nlibrary(dplyr)\ngroup_by(eastmoneytd,.dots=`職業`) %>%\n  summarise(`未滿一萬元職業(東)`=n()) %>%\n  arrange(desc(`未滿一萬元職業(東)`))\n\neastmoneyjobtd<-eastmoneytd[grepl(\"家庭管理\",eastmoneytd$`職業`),]\n\nlibrary(dplyr)\ngroup_by(eastmoneyjobtd,.dots=`年齡`) %>%\n  summarise(`未滿一萬元家庭管理年齡(東)`=n()) %>%\n  arrange(desc(`未滿一萬元家庭管理年齡(東)`))\n\ntraveldatam <- traveldata[grepl(\"中部\",traveldata$`居住地區`),] #中部旅遊的表單\n\nlibrary(dplyr)\ngroup_by(traveldatam,.dots=`個人每月平均所得`) %>%\n  summarise(`個人每月平均所得(中)`=n()) %>%\n  arrange(desc(`個人每月平均所得(中)`)) #中部月所得旅遊表單\n\nmiddlemoneytd<-traveldatam[grepl(\"二萬元至未滿三萬元\",traveldatam$`個人每月平均所得`),]\n\nlibrary(dplyr)\ngroup_by(middlemoneytd,.dots=`職業`) %>%\n  summarise(`二萬元至未滿三萬元職業(中)`=n()) %>%\n  arrange(desc(`二萬元至未滿三萬元職業(中)`))\n\nmiddlemoneyjobtd<-middlemoneytd[grepl(\"服務及銷售工作人員\",middlemoneytd$`職業`),]\n\nlibrary(dplyr)\ngroup_by(middlemoneyjobtd,.dots=`年齡`) %>%\n  summarise(`二萬元至未滿三萬元服務及銷售工作人員年齡(中)`=n()) %>%\n  arrange(desc(`二萬元至未滿三萬元服務及銷售工作人員年齡(中)`))\n\ntraveldatao <- traveldata[grepl(\"離島地區\",traveldata$`居住地區`),] #離島旅遊的表單\n\nlibrary(dplyr)\ngroup_by(traveldatao,.dots=`個人每月平均所得`) %>%\n  summarise(`個人每月平均所得(離島)`=n()) %>%\n  arrange(desc(`個人每月平均所得(離島)`)) #離島月所得旅遊表單\n\noutmoneytd<-traveldatao[grepl(\"未滿一萬元\",traveldatao$`個人每月平均所得`),]\n\nlibrary(dplyr)\ngroup_by(outmoneytd,.dots=`職業`) %>%\n  summarise(`未滿一萬元職業(離島)`=n()) %>%\n  arrange(desc(`未滿一萬元職業(離島)`))\n\noutmoneyjobtd<-outmoneytd[grepl(\"家庭管理\",outmoneytd$`職業`),]\n\nlibrary(dplyr)\ngroup_by(outmoneyjobtd,.dots=`年齡`) %>%\n  summarise(`未滿一萬元家庭管理年齡(離島)`=n()) %>%\n  arrange(desc(`未滿一萬元家庭管理年齡(離島)`))\n\ntraveldatanomoney <- traveldata[grepl(\"無收入\",traveldata$`個人每月平均所得`),] #無收入旅遊的表單\n\nlibrary(dplyr)\ngroup_by(traveldatanomoney,.dots=`職業`) %>%\n  summarise(`無收入職業`=n()) %>%\n  arrange(desc(`無收入職業`)) #無收入旅遊的職業\n\nseason1<-traveldata[grepl(\"一月~三月\",traveldata$`季別`),]#訪問季別一~三\nseason4<-traveldata[grepl(\"四月~六月\",traveldata$`季別`),]#訪問季四~六\nseason7<-traveldata[grepl(\"七月~九月\",traveldata$`季別`),]#訪問季別七~九\nseason10<-traveldata[grepl(\"十月~十二月\",traveldata$`季別`),]#訪問季別十~十二\nmarry<-traveldata[grepl(\"已婚\",traveldata$`婚姻狀況`),]\nnotmarry<-traveldata[grepl(\"未婚\",traveldata$`婚姻狀況`),]\ndie<-traveldata[grepl(\"喪偶\",traveldata$`婚姻狀況`),]\ndivorce<-traveldata[grepl(\"離婚或分居\",traveldata$`婚姻狀況`),]\nmale<-traveldata[grepl(\"男\",traveldata$`性別`),]\nfemale<-traveldata[grepl(\"女\",traveldata$`性別`),]\n\n#訪問季別1~3\ngroup_by(season1,.dots=`季別`) %>%\n  summarise(`季別`=n()) %>%\n  arrange(desc(`季別`))\n#訪問季別4~6\ngroup_by(season4,.dots=`季別`) %>%\n  summarise(`季別`=n()) %>%\n  arrange(desc(`季別`))\n#訪問季別7~9\ngroup_by(season7,.dots=`季別`) %>%\n  summarise(`季別`=n()) %>%\n  arrange(desc(`季別`)) \n#訪問季別10~12\ngroup_by(season10,.dots=`季別`) %>%\n  summarise(`季別`=n()) %>%\n  arrange(desc(`季別`))\n\n#婚姻狀況\ngroup_by(marry,.dots=`婚姻狀況`) %>%\n  summarise(`婚姻狀況`=n()) %>%\n  arrange(desc(`婚姻狀況`)) \ngroup_by(notmarry,.dots=`婚姻狀況`) %>%\n  summarise(`婚姻狀況`=n()) %>%\n  arrange(desc(`婚姻狀況`)) \ngroup_by(die,.dots=`婚姻狀況`) %>%\n  summarise(`婚姻狀況`=n()) %>%\n  arrange(desc(`婚姻狀況`))\ngroup_by(divorce,.dots=`婚姻狀況`) %>%\n  summarise(`婚姻狀況`=n()) %>%\n  arrange(desc(`婚姻狀況`)) \n#性別\ngroup_by(male,.dots=`性別`) %>%\n  summarise(`性別`=n()) %>%\n  arrange(desc(`性別`))\ngroup_by(female,.dots=`性別`) %>%\n  summarise(`性別`=n()) %>%\n  arrange(desc(`性別`))\n\n\nlibrary(dplyr)\ngroup_by(traveldata,.dots=`各季國內旅遊總次數`) %>%\n  summarise(`性別`=n()) %>%\n  arrange(desc(`性別`)) \n\nlibrary(dplyr)\ntraveldata %>% \n  select(`性別`,`各季國內旅遊總次數`) %>% \n  group_by(.dots=`性別`) %>%\n  summarise(`男女各季國內旅遊總次數`=mean(`各季國內旅遊總次數`)) %>%\n  arrange(desc(`男女各季國內旅遊總次數`))\n\nlibrary(dplyr)\ntraveldata %>% \n  select(`職業`,`各季國內旅遊總次數`) %>% \n  group_by(.dots=`職業`) %>%\n  summarise(`職業各季國內旅遊總次數`=mean(`各季國內旅遊總次數`)) %>%\n  arrange(desc(`職業各季國內旅遊總次數`))\n\n\nlibrary(readr)\ntraveldata <- read.csv(\"C:/Users/Eileen/Desktop/taiwantravel.csv\",fileEncoding =\"Big5\")\nView(traveldata)\n\ntraveldatan <- traveldata[grepl(\"北部\",traveldata$`居住地區`),] #北部旅遊的表單\n\nlibrary(data.table)\ntraveldatan$個人每月平均所得<-as.numeric(traveldatan$個人每月平均所得)\nlibrary(dplyr)\nnorthmoneytimestd<-traveldatan %>% \n  select(`居住地區`,`個人每月平均所得`,`各季國內旅遊總次數`) %>% \n  group_by(Revenue=`個人每月平均所得`,Area=`居住地區`) %>%\n  summarise(`國內旅遊總次數`=mean(`各季國內旅遊總次數`)) %>%\n  arrange(desc(`國內旅遊總次數`))\nstr(northmoneytimestd)\nnorthmoneytimestd$國內旅遊總次數<-as.numeric(northmoneytimestd$國內旅遊總次數)\n\ntraveldatae <- traveldata[grepl(\"東部\",traveldata$`居住地區`),] #東部旅遊的表單\n\nlibrary(data.table)\ntraveldatae$個人每月平均所得<-as.numeric(traveldatae$個人每月平均所得)\neastmoneytimestd<-traveldatae %>% \n  select(`居住地區`,`個人每月平均所得`,`各季國內旅遊總次數`) %>% \n  group_by(Revenue=`個人每月平均所得`,Area=`居住地區`) %>%\n  summarise(`國內旅遊總次數`=mean(`各季國內旅遊總次數`)) %>%\n  arrange(desc(`國內旅遊總次數`))\nstr(eastmoneytimestd)\n\ntraveldatas <- traveldata[grepl(\"南部\",traveldata$`居住地區`),] #南部旅遊的表單\n\nlibrary(data.table)\ntraveldatas$個人每月平均所得<-as.numeric(traveldatas$個人每月平均所得)\nsouthmoneytimestd<-traveldatas %>% \n  select(`居住地區`,`個人每月平均所得`,`各季國內旅遊總次數`) %>% \n  group_by(Revenue=`個人每月平均所得`,Area=`居住地區`) %>%\n  summarise(`國內旅遊總次數`=mean(`各季國內旅遊總次數`)) %>%\n  arrange(desc(`國內旅遊總次數`))\nstr(southmoneytimestd)\n\ntraveldatam <- traveldata[grepl(\"中部\",traveldata$`居住地區`),] #中部旅遊的表單\n\nlibrary(data.table)\ntraveldatam$個人每月平均所得<-as.numeric(traveldatam$個人每月平均所得)\nmiddlemoneytimestd<-traveldatam %>% \n  select(`居住地區`,`個人每月平均所得`,`各季國內旅遊總次數`) %>% \n  group_by(Revenue=`個人每月平均所得`,Area=`居住地區`) %>%\n  summarise(`國內旅遊總次數`=mean(`各季國內旅遊總次數`)) %>%\n  arrange(desc(`國內旅遊總次數`))\nstr(middlemoneytimestd)\n\ntraveldatao <- traveldata[grepl(\"離島地區\",traveldata$`居住地區`),] #離島旅遊的表單\n\nlibrary(data.table)\ntraveldatao$個人每月平均所得<-as.numeric(traveldatao$個人每月平均所得)\noutmoneytimestd<-traveldatao %>% \n  select(`居住地區`,`個人每月平均所得`,`各季國內旅遊總次數`) %>% \n  group_by(Revenue=`個人每月平均所得`,Area=`居住地區`) %>%\n  summarise(`國內旅遊總次數`=mean(`各季國內旅遊總次數`)) %>%\n  arrange(desc(`國內旅遊總次數`))\nstr(outmoneytimestd)\n\n\nlibrary(ggplot2)\nlibrary(plyr) \n#總結齒成長紀錄(60筆彙總成6筆) \ntg <- ddply(northmoneytimestd, c(\"Area\", \"國內旅遊總次數\"), summarise, Revenue = mean(Revenue)) \n#檢視整理完成的數據 \ntg \n#(6)用給藥方式來畫線(colour) \nggplot(tg, aes(x = Revenue, y = `國內旅遊總次數`, colour =Area )) + \n  geom_line(linetype = \"dashed\",size=4,stat=\"identity\",position = \"identity\") + \n  geom_point(shape = 22, size = 5, fill = \"white\")\n\n\ntemp<-movie_metadata %>% select(movie_title,title_year)\np<-temp %>% group_by(title_year) %>% summarise(n=n())%>%plot_ly(x = ~title_year, y = ~n, type = 'scatter', mode = 'lines')\nexport(p%>%add_trace( x =~title_year, y = ~fitted(loess(n ~ as.numeric(title_year))))%>%layout(title = \"Movies per Year\",showlegend = FALSE))",
    "created" : 1495896887835.000,
    "dirty" : true,
    "encoding" : "",
    "folds" : "",
    "hash" : "97413099",
    "id" : "3B525CDC",
    "lastKnownWriteTime" : 13229804949012596,
    "last_content_update" : 1496154651479,
    "path" : null,
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}